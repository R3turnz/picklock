var form=document.forms[0];var keyInput=form.elements.key;var unmaskButton=document.getElementById("unmask");var generateButton=document.getElementById("generate");function maskPassword(){keyInput.removeEventListener("focus",maskPassword);keyInput.type="password";unmaskButton.disabled=!1}
unmaskButton.addEventListener("click",function(event){event.preventDefault();unmaskButton.disabled=!0;keyInput.type="text";keyInput.addEventListener("focus",maskPassword)});form.addEventListener("submit",function(event){event.preventDefault();generateButton.disabled=!0;maskPassword();let service=form.elements.service.value;let key=keyInput.value;let bytes=new TextEncoder().encode(service+key);let salt=Uint8Array.from(atob("qS4rkSr5KGt"),c=>c.charCodeAt(0));window.crypto.subtle.importKey("raw",bytes,{name:"PBKDF2"},!1,["deriveBits"]).then(function(key){window.crypto.subtle.deriveBits({name:"PBKDF2",hash:"SHA-512",salt:salt,iterations:100000},key,144).then(function(hash){let password=btoa(String.fromCharCode(...new Uint8Array(hash)));displayResult(password);form.addEventListener("input",enableGenerateButton)})})});function displayResult(password){let passwordSpan=document.getElementById("password");if(passwordSpan!==null){passwordSpan.textContent=password;let copyButton=document.getElementById("copy");copyButton.textContent="Copy";copyButton.disabled=!1;return}
let resultDiv=document.createElement("div");resultDiv.setAttribute("id","result");passwordSpan=document.createElement("span");passwordSpan.setAttribute("id","password");passwordSpan.textContent=password;resultDiv.appendChild(passwordSpan);let copyButton=document.createElement("button");copyButton.setAttribute("id","copy")
copyButton.textContent="Copy";copyButton.addEventListener("click",copyPassword);resultDiv.appendChild(copyButton);let containerDiv=document.getElementsByClassName("container")[0];containerDiv.appendChild(resultDiv)}
function copyPassword(event){event.target.disabled=!0;let password=document.getElementById("password");let selection=window.getSelection();let range=document.createRange();range.selectNodeContents(password);selection.removeAllRanges();selection.addRange(range);document.execCommand("copy");selection.removeAllRanges();event.target.textContent="Copied to clipboard!"}
function enableGenerateButton(){form.removeEventListener("input",enableGenerateButton);generateButton.disabled=!1}
